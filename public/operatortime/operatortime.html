<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>Time Entry Form</title>
  <link href="operatortime.css" rel="stylesheet"/>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <script src="operatortime.js" defer></script>
 </head>
 <body>
  <div class="app-container">
   <aside class="sidebar">
    <div class="logo">Logo</div>
    <nav>
     <ul>
      <li class="nav-item" data-target="homeView">HOME</li>
      <li class="nav-item hidden" data-target="timeFormView">TIME ENTRY FORM</li>
      <li class="nav-item hidden" data-target="recordsView">TIME RECORDS</li>
      <li class="nav-item hidden" data-target="woView">WO LIST</li>
      <li class="nav-item hidden" data-target="adminView">ADMIN</li>
     </ul>
    </nav>
   </aside>
   <main class="main-content">
    <div class="header">
     <div class="title">ABSORPTION DATA</div>
     <div style="margin-bottom: 20px;">
      <button onclick="window.location.href='../index.html'" style="padding: 8px 18px; font-size: 16px;">
         ‚Üê Return to Main
      </button>
     </div>
     <div class="auth">
      <input id="username" placeholder="User name" type="text"/>
      <input id="password" placeholder="Password" type="password"/>
      <button id="signinBtn">Sign In</button>
      <button id="signoutBtn" style="display:none;">Sign Out</button>
     </div>
    </div>
    <div class="view-section hidden" id="timeFormView">
     <h2>Time Entry Form</h2>
     <form class="simple-form" id="timeEntryForm">
      <fieldset>
       <legend>Work Order</legend>
       <div class="form-row work-order-row">
        <label class="required-label">WONO
         <input id="wono" required type="text" class="required-input"/>
        </label>
        <label>Part No
         <input id="partno" type="text"/>
        </label>
        <label>Description
         <input id="desc" type="text"/>
        </label>
        <label>WO QTY
         <input id="woqty" type="text"/>
        </label>
        <label>Demand Date
         <input id="demandDate" type="date"/>
        </label>
       </div>
      </fieldset>
      <fieldset>
       <legend>Operation</legend>
       <div class="form-row operation-row">
        <label class="required-label">OPN NO
         <input id="opnno" required type="text" class="required-input"/>
        </label>
        <label>Setup/Run
         <select id="setupRun">
           <option value="">-- Select --</option>
           <option value="Setup">Setup</option>
           <option value="Run">Run</option>
         </select>
        </label>
        <label>M/C No
         <input id="mcCode" required type="text"/>
        </label>
        <label>EMP Code
         <input id="empCode" required type="text"/>
        </label>
        <label>Shift
         <select id="shift">
           <option value="">-- Select --</option>
           <option value="Morn(7a-3p)">Morn(7a-3p)</option>
           <option value="Day(7a-7p)">Day(7a-7p)</option>
           <option value="Even(3p-11p)">Even(3p-11p)</option>
           <option value="Night(7p-7a)">Night(7p-7a)</option>
         </select>
        </label>
        <label>QTY Completed
         <input id="qtyCompleted" step="0.01" type="number"/>
        </label>
        <div class="inline-group">
         <label>OPN Start
          <input id="opnStart" readonly type="text"/>
         </label>
         <button id="opnStartBtn" type="button">Set Start</button>
        </div>
        <div class="inline-group">
         <label>OPN Stop
          <input id="opnStop" type="text"/>
         </label>
         <button id="opnStopBtn" type="button">Set Stop</button>
        </div>
       </div>
      </fieldset>
      <fieldset>
       <legend>Indirect Time (in minutes)</legend>
       <div class="form-row indirect-row">
        <label>In Prog<input id="inprog" type="number"/></label>
        <label>In ME<input id="inme" type="number"/></label>
        <label>In Prog OP<input id="inprogop" type="number"/></label>
        <label>In INSP<input id="ininsp" type="number"/></label>
        <label>In FAI<input id="infai" type="number"/></label>
        <label>In GAGE<input id="ingage" type="number"/></label>
        <label>Wait Crane<input id="inwaitcrane" type="number"/></label>
        <label>Wait Fork<input id="inwaitfork" type="number"/></label>
        <label>Maint<input id="inmaint" type="number"/></label>
        <label>No Load<input id="innoload" type="number"/></label>
        <label>Indir Work<input id="inindir" type="number"/></label>
        <label>Safety Mee<input id="insafety" type="number"/></label>
        <label>Meeting<input id="inmeeting" type="number"/></label>
        <label>Tea Break<input id="teaBreak" type="number"/></label>
        <label>Lunch/Dinner<input id="lunch" type="number"/></label>
       </div>
      </fieldset>
      <div class="form-actions">
       <button id="saveBtn" type="submit">Save</button>
       <button id="resetBtn" type="button">Reset</button>
      </div>
     </form>
     <h3>Time Entry Summary</h3>
     <table id="entrySummary">
      <thead>
       <tr>
        <th>ID</th>
        <th>WONO</th>
        <th>PARTNO</th>
        <th>DESCRIPTION</th>
        <th>DEMAND DATE</th>
        <th>OPN NO</th>
        <th>OPN TYPE</th>
        <th>M/C NO</th>
        <th>EMP CODE</th>
        <th>SHIFT</th>
        <th>OPN START</th>
        <th>QTY</th>
        <th>OPN STOP</th>
        <th>Indirect Times...</th>
        <th>Select</th>
       </tr>
      </thead>
      <tbody></tbody>
     </table>
    </div>
    <div class="view-section" id="homeView">
      <div class="dashboard-controls" style="margin: 10px;">
        <label for="yearDropdown">Year:</label>
        <select id="yearDropdown" name="yearDropdown" title="Select Year" aria-label="Select Year"></select>
        <label for="monthDropdown">Month:</label>
        <select id="monthDropdown" name="monthDropdown" title="Select Month" aria-label="Select Month"></select>
      </div>
      <div class="dashboard-grid">
        <div class="dashboard-chart" id="chart1-container">
          <h3>Daily Absorption Graph</h3>
          <canvas id="chart1" width="400" height="200" aria-label="Daily Absorption Graph" role="img"></canvas>
        </div>
        <div class="dashboard-chart" id="chart2-container">
          <h3>Month to date indirect hours</h3>
          <canvas id="chart2" width="400" height="200" aria-label="Month to date indirect hours" role="img"></canvas>
        </div>
        <div class="dashboard-chart" id="chart3-container">
          <h3>Monthly Absorption Graph</h3>
          <canvas id="chart3" width="400" height="200" aria-label="Monthly Absorption Graph" role="img"></canvas>
        </div>
        <div class="dashboard-chart" id="chart4-container">
          <h3>Year to date indirect hours</h3>
          <canvas id="chart4" width="400" height="200" aria-label="Year to date indirect hours" role="img"></canvas>
        </div>
      </div>
      <div class="dashboard-fullwidth" id="chart5-container">
        <h3>Total Operation Time by Employee/Month</h3>
        <canvas id="chart5" width="800" height="300" aria-label="Employee Operation Matrix" role="img"></canvas>
        <div id="chart5-table"></div>
      </div>
    </div>
    <div class="view-section hidden" id="recordsView">
      <h2>Time Records</h2>
      <div class="button-row">
        <button onclick="deleteSelectedTimeRecords()">Delete Selected</button>
        <button onclick="toggleSelectAllTimeRecords(document.getElementById('selectAllTimeRecords'))">Select All</button>
        <button id="exportExcelBtn">Download as Excel</button>
      </div>
      <table id="timeRecordsTable">
        <thead>
          <tr>
            <th><input type="checkbox" id="selectAllTimeRecords" onchange="toggleSelectAllTimeRecords(this)" /></th>
            <th>ID</th>
            <th>WONO</th>
            <th>PARTNO</th>
            <th>DESCRIPTION</th>
            <th>DEMANDDATE</th>
            <th>OPNNO</th>
            <th>OPN TYPE</th>
            <th>M/C NO</th>
            <th>EMPCode</th>
            <th>SHIFT</th>
            <th>OPNSTARTTIME</th>
            <th>MonYY</th>
            <th>QTY COMPLETED</th>
            <th>OPNSTOPTIME</th>
            <th>IN PROG</th>
            <th>IN ME</th>
            <th>IN PROG-OP</th>
            <th>IN INSP</th>
            <th>IN FAI</th>
            <th>IN GAGE</th>
            <th>IN WAIT-CRANE</th>
            <th>IN WAIT-FORK</th>
            <th>IN MAINT</th>
            <th>IN NOLOAD</th>
            <th>IN INDIRCT</th>
            <th>IN SAFETY M</th>
            <th>IN MEETING</th>
            <th>TBREAK</th>
            <th>LUNCHDINNER</th>
            <th>Total Indirect Time</th>
            <th>Total OPN Time</th>
            <th>Actual Absorption</th>
            <th>Mon-Year</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
    <div class="view-section hidden" id="woView">
     <h2>WO List</h2>
     <div class="filters" style="display:flex; gap:8px; align-items:center; flex-wrap:wrap;">
  	<label for="demandFrom">Demand Date From</label>
  	<input id="demandFrom" type="date" onchange="filterWOList()" />
  	<label for="demandTo">Demand Date To</label>
  	<input id="demandTo" type="date" onchange="filterWOList()" />
  	<label for="searchWONO">Search WO No</label>
  	<input type="text" id="searchWONO" placeholder="Enter WO No" oninput="filterWOList()" />
  	<input type="text" id="searchPARTNO" placeholder="Enter PART No" oninput="filterWOList()" />
  	<button type="button" onclick="filterWOList()">Search</button>
  	<button type="button" onclick="document.getElementById('importWOInput').click()">Import WO Data</button>
  	<input type="file" id="importWOInput" accept=".csv,.xlsx" style="display:none;" onchange="handleWOImport(event)" />
     </div>
     <div class="button-row">
       <button onclick="enableWOEditing()">Edit Lines</button>
       <button onclick="saveWOData()">Save</button>
       <button onclick="cancelWOEditing()">Cancel</button>
       <button onclick="deleteSelectedWO()">Delete Selected</button>
     </div>
     <div class="table-container">
      <table id="woListTable">
       <thead>
        <tr>
         <th><input type="checkbox" id="selectAllWO" onchange="toggleSelectAllWO(this)" /></th>
         <th>WONO</th>
         <th>PARTNO</th>
         <th>Description</th>
         <th>WOQTY</th>
         <th>DEMANDDATE</th>
         <th>BarCode</th>
         <th>Action</th>
        </tr>
       </thead>
       <tbody>
        <!-- Data rows inserted by JS -->
       </tbody>
      </table>
     </div>
    </div>
    <div class="view-section hidden" id="adminView">
     <h2>Admin Rights Management</h2>
     <table id="adminRightsTable">
       <thead>
         <tr>
           <th>User ID</th>
           <th>Designation</th>
           <th>Password</th>
           <th>Time Entry Form-View</th>
           <th>Time Entry Form-View & Edit</th>
           <th>Time Records-View</th>
           <th>Time Records-View & Export</th>
           <th>WOList-View & Search</th>
           <th>WOList-View, Search & Import</th>
           <th>Action</th>
         </tr>
         <!-- Add new user row -->
         <tr>
           <td><input type="text" id="addUserID" /></td>
           <td><input type="text" id="addDesignation" /></td>
           <td><input type="password" id="addPassword" /></td>
           <td><input type="checkbox" id="addV1" /></td>
           <td><input type="checkbox" id="addV2" /></td>
           <td><input type="checkbox" id="addV3" /></td>
           <td><input type="checkbox" id="addV4" /></td>
           <td><input type="checkbox" id="addV5" /></td>
           <td><input type="checkbox" id="addV6" /></td>
           <td><button onclick="addAdminUser()">Add</button></td>
         </tr>
       </thead>
       <tbody>
       </tbody>
     </table>
   </div>
    <!-- Admin Login Modal/Prompt (Hidden by default) -->
   <div id="adminLoginModal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.25); z-index:2000; align-items:center; justify-content:center;">
    <div style="background:#fff; padding:32px 24px; border-radius:8px; min-width:320px; margin:auto;">
     <h3>Admin Login</h3>
     <label>Username <input type="text" id="adminLoginUser" /></label><br><br>
     <label>Password <input type="password" id="adminLoginPass" /></label><br><br>
     <button onclick="handleAdminLogin()">Sign In</button>
     <button onclick="closeAdminModal()" style="margin-left:12px;">Cancel</button>
     <div id="adminLoginError" style="color:red; margin-top:10px;"></div>
    </div>
   </div>
   </main>
   <style>
   /* Minimal styling for popup */
   .modal { position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.3); display:flex; align-items:center; justify-content:center; z-index: 2000;}
   .modal-content { background:#fff; padding:2em; border-radius:8px; min-width:250px;}
   </style>
  </div>
 </body>
</html>
